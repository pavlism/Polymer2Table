<script src="../Libs/logger.js"></script>
<script src="../Libs/JSLIB.js"></script>
<script src="../Libs/Brokers.js"></script>
<script src="../Libs/stringEXT.js"></script>

<link rel="import" href="ui-table-style.html">
<link rel="import" href="../ui-button-set/ui-csv-button/ui-csv-button.html">
<link rel="import" href="../ui-button-set/ui-excel-button/ui-excel-button.html">
<link rel="import" href="../ui-button-set/ui-copy-button/ui-copy-button.html">
<link rel="import" href="../ui-button-set/ui-print-button/ui-print-button.html">
<link rel="import" href="../ui-button-set/ui-pdf-button/ui-pdf-button.html">

<dom-module id="ui-table">
    <template>
        <style include="ui-table-style"></style>
                
        
        <template is="dom-if" if="[[searchable]]">
            <span class="text"><b>Search:</b></span><ui-text-box type="text" name="search" on-keyup="keyup"></ui-text-box>
        </template>
        
        <template is="dom-if" if="[[buttons]]">
            <ui-csv-button data-call="[[id]]_CurrentData"></ui-csv-button>
            <ui-excel-button data-call="[[id]]_CurrentData"></ui-excel-button>
            <ui-copy-button data-call="[[id]]_CurrentData"></ui-copy-button>
            <ui-print-button data-call="[[id]]_CurrentTableElement"></ui-print-button>
            <ui-pdf-button data-call="[[id]]_CurrentTableElement"></ui-pdf-button>
        </template>
        
        
        <table border="1" id="[[id]]_table" class="table table-striped table-bordered table-hover dataTables-example dataTable dtr-inline UI-Table" on-click='handleClick' on-double-click="handleDblClick">
            <thead>
                <tr>
                    <template is="dom-repeat" items="[[getHeader(data)]]">
                        <th>[[item]]<i></i></th>
                    </template>
                </tr>
            </thead>
            <tbody>
                <template is="dom-repeat" items="{{data}}" as="row" filter="{{searchFilter(searchString, data)}}" observe="searchString">
                    <template is="dom-if" if="{{showRow(index,0,pageListValue, currentPage)}}">
                        <tr>
                            <template is="dom-repeat" items="{{row}}" as="cell">
                                <td>
                                    <template is="dom-if" if="[[matchCellType(cell, 'buttons')]]">
                                        <template is="dom-repeat" items="[[cell.buttons]]" as="button">
                                            <UI-Button id='[[button.ID]]' class$='[[button.class]]'>[[button.text]]</UI-Button>
                                        </template>
                                    </template>
                                    <template is="dom-if" if="[[matchCellType(cell, 'button')]]">
                                        <UI-Button id='[[cell.button.ID]]' class$='[[cell.button.class]]'>[[cell.button.text]]</UI-Button>
                                    </template>
                                    <template is="dom-if" if="[[matchCellType(cell, 'object')]]">
                                        <span class="object-toggle"></span>[[cell.title]]
                                        <div class="properties">
                                            <template is="dom-repeat" items="[[getProps(cell)]]">
                                                <div class="properties_row"><div class="properties_cell"><b>[[item.title]]:</b></div><div style="display: table-cell">[[item.val]]</div></div>
                                            </template>
                                        </div>
                                    </template>
                                    <template is="dom-if" if="[[matchCellType(cell, 'link')]]">
                                        <a target="_blank" href='[[cell.link.href]]'>[[cell.link.text]]</a>
                                    </template>
                                    <template is="dom-if" if="[[matchCellType(cell, 'cell')]]">
                                        [[cell]]
                                    </template>
                                </td>
                            </template>
                        </tr>
                    </template>
                </template>
            </tbody>
        </table>
        <template is="dom-if" if="[[pages]]">
            <div class='pages'>
                <UI-Button on-click="handleClick">Previous</UI-Button>
                <template is="dom-repeat" items="[[getPages(maxLength,pageListValue)]]">
                    <template is="dom-if" if="[[isCurrentPage(index, currentPage)]]"><UI-Button on-click="handleClick" class="primary">[[item]]</UI-Button></template>
                    <template is="dom-if" if="[[!isCurrentPage(index, currentPage)]]"><UI-Button on-click="handleClick">[[item]]</UI-Button></template>
                </template>
                <UI-Button on-click="handleClick">Next</UI-Button>
            </div>
        </template>
    </template>

    <script src="ui-table.js" type="text/javascript"></script>

</dom-module>